# Telegram Online Spy

Бот для отслеживания онлайн-статуса пользователей Telegram. Позволяет добавлять пользователей в список отслеживания и получать уведомления, когда они входят в сеть или выходят из нее.

## Как это работает

Скрипт `spy.py` запускает бота, с которым вы можете взаимодействовать через Telegram. Через команды бота вы добавляете/удаляете пользователей из списка отслеживания.

Бот будет отправлять вам сообщения, когда любой из пользователей в списке изменит свой онлайн-статус.

## Установка

```bash
pip install -r requirements.txt
```

## Настройка

1. Создайте свое Telegram приложение на [https://my.telegram.org/apps](https://my.telegram.org/apps) и замените `API_HASH`, `API_ID` в файле `spy.py` на ваши значения.

```python
API_HASH = 'ваш api hash'
API_ID = 'ваш api id'
BOT_TOKEN = "токен вашего бота"
USER_NAME = "ваше имя пользователя"
```

2. Создайте бота в вашем клиенте Telegram (напишите сообщение @BotFather) и скопируйте токен бота в приложение.

## Запуск

```bash
python3 spy.py
```

Затем введите номер вашего аккаунта Telegram, который будет отправлять запросы для получения статуса пользователей. Не вводите токен бота, так как это не будет работать.
Введите код из Telegram в консоль.

## Команды

Напишите `/help` вашему боту, чтобы увидеть информацию об использовании.

```
/start - начать мониторинг онлайн-статуса
/stop - остановить мониторинг онлайн-статуса
/help - показать справку
/add - добавить пользователя в список мониторинга "/add +79991234567 ИмяПользователя"
/list - показать добавленных пользователей
/clear - очистить список пользователей
/remove - удалить пользователя из списка по позиции в списке (для отображения используйте команду /list)"/remove 1"
/setdelay - установить задержку между проверками пользователей в секундах
/logs - отобразить журнал команд
/clearlogs - очистить файл журнала команд
/cleardata - сбросить конфигурацию
/disconnect - отключить бота
/getall - статус
```

## Автоматический запуск

Для удобства управления ботом в репозитории есть несколько скриптов:

1. `start_spy.sh` - запускает бота в фоновом режиме
2. `check_spy.sh` - проверяет, запущен ли бот
3. `stop_spy.sh` - останавливает бота

Чтобы использовать эти скрипты:

```bash
# Сделать скрипты исполняемыми (если еще не сделано)
chmod +x start_spy.sh check_spy.sh stop_spy.sh

# Запустить бота в фоновом режиме
./start_spy.sh

# Проверить, запущен ли бот
./check_spy.sh

# Остановить бота
./stop_spy.sh
```

Для автоматического запуска при загрузке системы можно использовать crontab:

```bash
# Открыть редактор crontab
crontab -e

# Добавить строку для запуска бота при перезагрузке
@reboot /полный/путь/к/TelegramOnlineSpy/start_spy.sh
```

## Получение API_ID и API_HASH

Подробная инструкция по получению API_ID и API_HASH находится в файле [API_SETUP.md](API_SETUP.md).

## Устранение неполадок

Если бот не работает или вылетает, проверьте следующее:

1. Правильно ли указаны API_ID, API_HASH и BOT_TOKEN в файле spy.py
2. Установлены ли все зависимости из requirements.txt
3. Имеет ли бот доступ к интернету
4. Проверьте логи в файле spy_log.txt для выявления ошибок

Если проблема не устраняется, попробуйте:
1. Удалить файлы сессий (data_thief.session и bot.session)
2. Перезапустить бота
3. Проверить, не заблокирован ли ваш аккаунт или бот в Telegram
